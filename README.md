
<!-- README.md is generated from README.Rmd. Please edit that file -->

# lordecks

<!-- badges: start -->
<!-- badges: end -->

The package can be used to encode/decode Legends of Runeterra decks
to/from simple strings. Such codes are e.g. generated by the game for
imports and exports and also how decks are specified in the game API.
Any analysis of matchdata therefore requires the ability to parse deck
codes into actual deck lists.

This is an R implementation following
<https://github.com/RiotGames/LoRDeckCodes> .

## Installation

You can install *lordecks* from github via:

``` r
remotes::install_github("https://github.com/pholzmgit/lordecks")
```

## Usage

### Parsing deck codes

The library provides a function that parses deck codes into
interpretable deck lists. For the output format, 2 options are available

-   minimalist character vector (“{count}:{cardcode}”, representing the
    testdata format of the original C\# library)
-   dataframe with some additional columns, ready for further analysis
    in R (default)

``` r
library(lordecks)

deck_code <- "CEDACAIFDUAQEBAIAECAIBICAECDGNACAMCQIBQDAMCAKDISAIAQCBBWAIAQKEZPAIAQGBIMAMAQKAIZEE"

simple_decklist <- get_decklist_from_code(deck_code, format = "simple")

simple_decklist
#>  [1] "3:01SI029" "3:02PZ008" "3:04PZ005" "3:01PZ051" "3:01PZ052" "3:03SI004"
#>  [7] "3:03SI006" "3:03PZ005" "3:03PZ013" "3:03PZ018" "2:01PZ054" "2:01SI019"
#> [13] "2:01SI047" "1:03SI012" "1:01SI001" "1:01SI025" "1:01SI033"
```

``` r
df_decklist <- get_decklist_from_code(deck_code)

df_decklist
#>    cardcode count faction set card_number
#> 1   01SI029     3      SI   1         029
#> 2   02PZ008     3      PZ   2         008
#> 3   04PZ005     3      PZ   4         005
#> 4   01PZ051     3      PZ   1         051
#> 5   01PZ052     3      PZ   1         052
#> 6   03SI004     3      SI   3         004
#> 7   03SI006     3      SI   3         006
#> 8   03PZ005     3      PZ   3         005
#> 9   03PZ013     3      PZ   3         013
#> 10  03PZ018     3      PZ   3         018
#> 11  01PZ054     2      PZ   1         054
#> 12  01SI019     2      SI   1         019
#> 13  01SI047     2      SI   1         047
#> 14  03SI012     1      SI   3         012
#> 15  01SI001     1      SI   1         001
#> 16  01SI025     1      SI   1         025
#> 17  01SI033     1      SI   1         033
```

### Generate deck codes

For both deck formats, functions for the reverse action are provided

``` r
get_code_from_decklist(simple_decklist)
#> [1] "CEDACAIFDUAQEBAIAECAIBICAECDGNACAMCQIBQDAMCAKDISAIAQCBBWAIAQKEZPAIAQGBIMAMAQKAIZEE"
```

``` r
# a dataframe with only 'cardcode' and 'count' columns is sufficient, all other columns are ignored
get_code_from_decklist_df(df_decklist)
#> [1] "CEDACAIFDUAQEBAIAECAIBICAECDGNACAMCQIBQDAMCAKDISAIAQCBBWAIAQKEZPAIAQGBIMAMAQKAIZEE"
```

## Note on deck code versions

The deck codes start with 4 bit for format and 4 bit for version. So far
this only indicates which regions are available - too old versions of
the decoder have no information on factions released more recently. The
C\# library always generates codes with the latest version, but the
actual game does not.

Instead, the lowest possible version based on the factions in the deck
is encoded. **In this aspect, the library follows the implementation of
the game**. While this results in slightly different deck codes, the
resulting decklists are identical.

``` r
#example code list provided from the test data set
code <- "CMAQSAIFBMHREHRAFEVCWMABAYAQKAIUDURSYLIBAEAQKGQ"

#manually import and re-export in the game (Patch 2.10)
code_game <- "CEAQSAIFBMHREHRAFEVCWMABAYAQKAIUDURSYLIBAEAQKGQ"

code_lordecks <- get_code_from_decklist_df(get_decklist_from_code(code))
code_lordecks
#> [1] "CEAQSAIFBMHREHRAFEVCWMABAYAQKAIUDURSYLIBAEAQKGQ"
```

``` r
identical(code, code_lordecks)
#> [1] FALSE
identical(code_game, code_lordecks)
#> [1] TRUE
```

``` r
identical(
  get_decklist_from_code(code),
  get_decklist_from_code(code_lordecks)
)
#> [1] TRUE
```
